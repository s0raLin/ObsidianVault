### 什么是流？
流是一种对象，它允许以小块（chunk）形式读取和写入数据。由于数据处理需加载到内存中，一次性读取全部内容可能导致内存不足，尤其是处理大文件时。以小块方式处理可避免内存溢出。此外，使用流还能节省时间：边读边写转换，而非全部复制到内存后再处理，从而显著缩短整体耗时。

### 流的类型

流不一定要同时进行读取、写入和转换操作。不同类型的流有不同功能，具体如下：

- **Readable 流** —— 用于读取数据。例如，`fs.createReadStream()` 可以帮助你读取文件内容。
- **Writable 流** —— 用于写入数据。例如，`fs.createWriteStream()` 可以让你写入数据到文件。
- **Duplex 流** —— 用于同时读取和写入数据。这种流允许你在同一对象上同时进行读写操作，比单独使用前两种流更方便。
- **Transform 流** —— 一种 duplex 流，可以对数据进行转换。如果你不仅要读取和写入文件，还希望对数据进行处理，就可以使用 transform 流。
    

所有流都是 `EventEmitter` 模块的实例。此外，流会触发如 `data`、`end`、`error`、`pause` 和 `close` 等事件


## 应用示例
你可能在许多 Node.js 模块中遇到流。来看下面的代码示例：
```js
const fs = require("node:fs");

const readStream = fs.createReadStream("./data.txt", {
    highWaterMark: 1000
});

readStream.on('data', (chunk) => {
    console.log("New chunk!");
    console.log(chunk);
});
```

#### 代码解析

在这个例子中，有一个名为 `readStream` 的可读流，它读取 `data.txt` 文件。`highWaterMark` 参数设置每次读取的块大小（以字节为单位）。默认值是 64 KiB

可读流会触发 `data` 事件，你可以处理这个事件并执行各种操作，例如将数据显示到控制台。在代码中有一个事件处理器，第一个参数是事件名，第二个参数是回调函数，它接收一个 `chunk`（数据块）并将其打印到控制台

默认情况下，数据以 **Buffer** 形式表示，而不是字符串。要将输出改为字符串格式，可以对每个 chunk 使用 `toString()` 方法。

可以看到，流允许你以块的形式读取文件。在整个文件读取完成之前，这些块可以被处理，从而保持数据的持续流动——即读取、处理、写入/输出同步进行。