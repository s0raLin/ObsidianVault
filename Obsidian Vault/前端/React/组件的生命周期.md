在React中，组件的生命周期可以理解为从诞生(被渲染到DOM中)到消亡(从DOM中移除)所经历的一系列事件

类组件拥有内置的生命周期，由生命周期不同阶段的的方法组成

函数组件本身没有内置生命周期，不过通过Hooks的引入，函数组件也获得了管理状态和执行副作用的能力。

## 组件生命周期的阶段
### 挂载阶段
组件被创建并插入到DOM中
### 更新阶段
组件的state或props发生变化
### 卸载阶段
组件从DOM中移除


在函数组件中，通常使用 `useState` 和 `useEffect` 等 Hooks 来管理这些阶段。而在早期的类组件中，则有一套对应的生命周期方法可供使用。
下面是一张组件生命周期的可视化示意图：
![[生命周期.png]]

### 一、挂载阶段（Mounting）

- **constructor**  
    构造函数在组件初始化时调用。通常用于设置初始状态以及绑定事件处理函数。
- **static getDerivedStateFromProps**  
    这是一个静态方法，在渲染之前调用，允许根据 props 的变化来更新 state。该方法使用频率较低，在函数组件中通常由 `useState` 代替。
- **render**  
    `render` 方法负责返回描述组件 UI 的 JSX。
- **componentDidMount**  
    该方法在组件挂载并插入 DOM 后立即调用。常用于执行副作用操作，如获取数据、添加事件监听等。

---

### 二、更新阶段（Updating）

- **static getDerivedStateFromProps**  
    在更新阶段同样会被调用，用于根据 props 的变化更新 state，使用较少。
- **shouldComponentUpdate**  
    当组件接收到新的 props 或 state 时，在重新渲染前调用。它允许你控制组件是否需要重新渲染。默认返回 `true`，你可以通过自定义逻辑来优化性能。
- **getSnapshotBeforeUpdate**  
    在虚拟 DOM 的变化反映到真实 DOM 之前调用。用于在 DOM 更新前获取一些信息，通常会和 `componentDidUpdate` 一起使用，应用场景较少。
- **render**  
    再次调用 `render` 方法，根据新的 state 或 props 更新 UI。
- **componentDidUpdate**  
    在组件更新并重新渲染后调用，常用于依赖于更新后 state 或 props 的副作用操作。
---

### 三、卸载阶段（Unmounting）

- **componentWillUnmount**  
    在组件即将被卸载并从 DOM 中移除前调用。用于清理组件生命周期中创建的资源，例如事件监听器、定时器等。


## 使用函数组件的生命周期

在函数组件中，生命周期方法由 **React Hooks** 取代，用于管理状态和执行副作用。


### 一、挂载阶段（Mounting）

- **useState**  
    `useState` 用于在函数组件中初始化和管理状态。它允许你声明一个状态变量以及更新该状态的函数，取代了类组件中的 constructor 和 `this.state`。
- **useEffect**  
    `useEffect` 用于执行副作用操作，如获取数据、订阅事件或操作 DOM。它在组件渲染后运行，当依赖数组为空时，可以模拟 `componentDidMount` 的行为。

---

### 二、更新阶段（Updating）

- **useState**  
    使用 `useState` 返回的更新函数修改状态会触发组件重新渲染。props 发生变化同样会导致组件重新渲染，这与类组件的更新机制一致。
- **useEffect**  
    你可以通过指定依赖项来控制副作用的执行时机。当依赖发生变化时，`useEffect` 会再次执行，这种方式可以模拟 `componentDidUpdate`。

---

### 三、卸载阶段（Unmounting）

- **useEffect 的清理函数**  
    在 `useEffect` 中返回一个清理函数，该函数会在组件卸载时执行。这可以模拟类组件中的 `componentWillUnmount`，用于清理资源。